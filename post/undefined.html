<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>RSA题型总结 | 奇怪的博客</title><meta name="author" content="Dorange"><meta name="copyright" content="Dorange"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RSA 基础定义基础字母含义明文$m$：用于以数字或字节形式记录信息公钥$e$：用于加密明文密文$m$：用于以数字或字节形式记录加密信息私钥$d$：用于解密密文模数$n$：用于加解密信息，安全性的核心欧拉函数$phi$(数学形式$\phi(n)$)：用于计算私钥质数$p$：用于解密质数$q$：用于解密 基础字母关系$n &#x3D; p × q$$\phi(n)  &#x3D; (p-1)(q-1">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA题型总结">
<meta property="og:url" content="https://lr2006-robot.github.io/post/undefined.html">
<meta property="og:site_name" content="奇怪的博客">
<meta property="og:description" content="RSA 基础定义基础字母含义明文$m$：用于以数字或字节形式记录信息公钥$e$：用于加密明文密文$m$：用于以数字或字节形式记录加密信息私钥$d$：用于解密密文模数$n$：用于加解密信息，安全性的核心欧拉函数$phi$(数学形式$\phi(n)$)：用于计算私钥质数$p$：用于解密质数$q$：用于解密 基础字母关系$n &#x3D; p × q$$\phi(n)  &#x3D; (p-1)(q-1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lr2006-robot.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2026-02-08T09:05:00.000Z">
<meta property="article:modified_time" content="2026-02-08T09:35:10.269Z">
<meta property="article:author" content="Dorange">
<meta property="article:tag" content="密码学,CTF,安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lr2006-robot.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "RSA题型总结",
  "url": "https://lr2006-robot.github.io/post/undefined.html",
  "image": "https://lr2006-robot.github.io/img/butterfly-icon.png",
  "datePublished": "2026-02-08T09:05:00.000Z",
  "dateModified": "2026-02-08T09:35:10.269Z",
  "author": [
    {
      "@type": "Person",
      "name": "Dorange",
      "url": "https://LR2006-Robot.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/myblog.github.io/img/favicon.png"><link rel="canonical" href="https://lr2006-robot.github.io/post/undefined.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/myblog.github.io/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/myblog.github.io/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'RSA题型总结',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/myblog.github.io/"><span class="site-name">奇怪的博客</span></a><a class="nav-page-title" href="/myblog.github.io/"><span class="site-name">RSA题型总结</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">RSA题型总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-08T09:05:00.000Z" title="发表于 2026-02-08 17:05:00">2026-02-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-08T09:35:10.269Z" title="更新于 2026-02-08 17:35:10">2026-02-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2><span id="rsa-基础定义">RSA 基础定义</span></h2><h3><span id="基础字母含义">基础字母含义</span></h3><p>明文$m$：用于以数字或字节形式记录信息<br>公钥$e$：用于加密明文<br>密文$m$：用于以数字或字节形式记录加密信息<br>私钥$d$：用于解密密文<br>模数$n$：用于加解密信息，安全性的核心<br>欧拉函数$phi$(数学形式$\phi(n)$)：用于计算私钥<br>质数$p$：用于解密<br>质数$q$：用于解密</p>
<h3><span id="基础字母关系">基础字母关系</span></h3><p>$n &#x3D; p × q$<br>$\phi(n)  &#x3D; (p-1)(q-1)$</p>
<p>$m^e \equiv c \ (\bmod \ n)$<br>$e × d \equiv 1 \ (\bmod \ \phi(n))$<br>$c^d \equiv m \ (\bmod \ n)$</p>
<h3><span id="基础定义例题">基础定义例题</span></h3><h4><span id="基础定义题目">基础定义题目</span></h4><pre><code class="language-python">import gmpy2
from Crypto.Util.number import *
from binascii import a2b_hex,b2a_hex

flag = &quot;*****************&quot;

p = 262248800182277040650192055439906580479
q = 262854994239322828547925595487519915551
e = 65533
n = p*q
c = pow(int(b2a_hex(flag),16),e,n)
print (c)
c = 27565231154623519221597938803435789010285480123476977081867877272451638645710
</code></pre>
<h4><span id="基础定义解题代码">基础定义解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse

p =
q =
c =
e =
n = p*q
d = inverse(e, (p-1)*(q-1))
m = pow(c, d, n)
print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-进阶定义">RSA 进阶定义</span></h2><h3><span id="进阶字母含义">进阶字母含义</span></h3><p>通过中国剩余定理CRT拆分运算<br>$dp$：辅助私钥参数<br>$dq$：辅助私钥参数</p>
<h3><span id="进阶字母关系">进阶字母关系</span></h3><p>$dp \equiv d \ (\bmod \ (p - 1))$<br>$dq \equiv d \ (\bmod \ (q - 1))$</p>
<p>$m1 \equiv c^dp \ (\bmod \ p)$<br>$m2 \equiv c^dq \ (\bmod \ q)$</p>
<p>$q^{-1}  × q \equiv 1 \ (\bmod \ p)$<br>$q^{-1} × (m1 - m2) \equiv h \ (\bmod \ p)$<br>$m2 + h × q \equiv m \ (\bmod \ n)$</p>
<p>$p^{-1}  × p \equiv 1 \ (\bmod \ q)$<br>$p^{-1} × (m2 - m1) \equiv h \ (\bmod \ q)$<br>$m1 + h × p \equiv m \ (\bmod \ n)$</p>
<h3><span id="进阶定义例题">进阶定义例题</span></h3><h4><span id="进阶定义题目">进阶定义题目</span></h4><pre><code class="language-python">p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229
q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469
dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929
dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041
c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852
</code></pre>
<h4><span id="进阶定义解题代码">进阶定义解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import inverse, long_to_bytes

n = p * q

m1 = pow(c, dp, p)
m2 = pow(c, dq, q)
q_inv = inverse(q, p)
h = (q_inv*(m1 - m2)) % p
m = (m2 + h*q) % n
print(m)
flag = long_to_bytes(m)
print(flag)
</code></pre>
<h2><span id="rsa-简单转化">RSA 简单转化</span></h2><h3><span id="简单转化出题思路">简单转化出题思路</span></h3><p>构建一些简单的关系如<br>$p + q$<br>$(p+1)(q+1)$<br>进行推到解密即可</p>
<h3><span id="简单转化例题">简单转化例题</span></h3><h4><span id="简单转化题目">简单转化题目</span></h4><pre><code class="language-python">p+q : 0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea
(p+1)(q+1) : 0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740
e : 0xe6b1bee47bd63f615c7d0a43c529d219
d : 0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5
enc_flag : 0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a
</code></pre>
<h4><span id="简单转化解题代码">简单转化解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse

part_hex =
total_hex =
e_hex =
d_hex =
c_hex =

part = int(part_hex, 16)
total = int(total_hex, 16)
e = int(e_hex, 16)
d = int(d_hex, 16)
c = int(c_hex, 16)
n = total - part - 1 #n = p × q = (p+1)(q+1) - (p+q) - 1

m = pow(c, d, n)
print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-方程相关运用">RSA 方程相关运用</span></h2><h3><span id="方程相关出题思路">方程相关出题思路</span></h3><p>构建一些次方级的方程进行求解，使用sympy库进行解方程即可</p>
<h3><span id="方程相关例题">方程相关例题</span></h3><h4><span id="方程相关题目">方程相关题目</span></h4><pre><code class="language-python">N=636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163
m1=90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239
m2=487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546

import hashlib
import sympy
from Crypto.Util.number import *

flag = &#39;GWHT{******}&#39;
secret = &#39;******&#39;

assert(len(flag) == 38)

half = len(flag) / 2

flag1 = flag[:half]
flag2 = flag[half:]

secret_num = getPrime(1024) * bytes_to_long(secret)

p = sympy.nextprime(secret_num)
q = sympy.nextprime(p)

N = p * q

e = 0x10001

F1 = bytes_to_long(flag1)
F2 = bytes_to_long(flag2)

c1 = F1 + F2
c2 = pow(F1, 3) + pow(F2, 3)
assert(c2 &lt; N)

m1 = pow(c1, e, N)
m2 = pow(c2, e, N)
</code></pre>
<h4><span id="方程相关解题代码">方程相关解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes
import gmpy2 as gp
from sympy import solve, symbols

e =
n =
c1 =
c2 =

p, ok = gp.iroot(n,2)
for i in range(100000):
    if n % p == 0:
        q = n // p
        print(f&quot;p = {p}&quot;)
        print(f&quot;q = {q}&quot;)
        break
    p = gp.next_prime(p)

phi = (p-1)*(q-1)
d = gp.invert(e, phi)
m1 = pow(c1, d, n)
m2 = pow(c2, d, n)
print(f&quot;m1 = {m1}&quot;)
print(f&quot;m2 = {m2}&quot;)

f1, f2 = symbols(&#39;f1 f2&#39;)
x = solve([f1 + f2 -m1,pow(f1,3) + pow(f2,3) - m2],[f1,f2])
print(f&quot;x = {x}&quot;)

f1 = 1141553212031156130619789508463772513350070909
f2 = 1590956290598033029862556611630426044507841845
flag1 = long_to_bytes(f1) + long_to_bytes(f2)
flag2 = long_to_bytes(f2) + long_to_bytes(f1)
print(f&quot;flag2 = {flag2}&quot;)
print(f&quot;flag1 = {flag1}&quot;)
</code></pre>
<h2><span id="rsa-小e爆破">RSA 小e爆破</span></h2><h3><span id="小e爆破出题思路">小e爆破出题思路</span></h3><p>特征是明显非常小的e，可以由关系<br>$m^e \equiv c \ (\bmod \ n)$<br>推导关系<br>$m &#x3D; \sqrt[e]{c + k × n}$</p>
<p>直接爆破k，当m是整数时就可以输出了</p>
<h3><span id="小e爆破例题">小e爆破例题</span></h3><h4><span id="小e爆破题目">小e爆破题目</span></h4><pre><code class="language-python">n= 0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793
e = 0x3
c = 0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365
#so,how to get the message?
</code></pre>
<h4><span id="小e爆破解题代码">小e爆破解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse
import gmpy2

n_hex =
e_hex =
c_hex =

n = int(n_hex,16)
e = int(e_hex,16)
c = int(c_hex,16)

for k in range(0,1000000):
    temp = c + k * n
    m, ok = gmpy2.iroot(temp, e)
    print(f&quot;Trying k={k}...&quot;, end=&quot;\r&quot;)
    if ok:
        print(long_to_bytes(int(m)))
        break
</code></pre>
<h2><span id="rsa-pq选取不当">RSA pq选取不当</span></h2><h3><span id="pq选取不当出题思路">pq选取不当出题思路</span></h3><p>p和q差值过大，可以直接进行小的范围爆破<br>p和q差值过小，可以通过费马因式分解进行爆破</p>
<h3><span id="费马因式分解在rsa中的应用">费马因式分解在RSA中的应用</span></h3><p>依据公式<br>$\frac{(p+q)^2}{4} - n &#x3D; \frac{(p+q)^2}{4} - pq &#x3D; \frac{(p-q)^2}{4}$<br>$|p-q|$比较小,那么$\frac{(p-q)^2}{4}$也小，所以$\frac{(p+q)^2}{4}$接近于n，可以通过不断增加$\frac{(p+q)}{2}$的值，直到$\frac{(p-q)^2}{4}$为完全平方数</p>
<p>设x&#x3D;$\frac{(p+q)}{2}$,y&#x3D;$\frac{(p-q)}{2}$<br>当满足$x^2 - n &#x3D; y^2$时即可求出方程</p>
<h3><span id="pq差值过大例题">pq差值过大例题</span></h3><h4><span id="pq差值过大题目">pq差值过大题目</span></h4><pre><code class="language-python">n = 1906011750017368771307796117673461157817901033778025473698320639347279300698085835647703350923834808686618760795173855605538695556283974551407384296775817454538392743419582983483423430619884117509611946945420798868634216459855241900807180705272425022537879022082812277121832800892726814372715231802506905483235703703  
c = 1813938701877845244891542403221397546309695735830614414823144998397779069720891016412390561291374385722837407507863630503077703755780891882029985205298169331480246769220977772002051973812821294349985237911202368331033856552284454208053314132392846017514315058559493210418463581508042060692714222299519015824148532123 
p = getPrime(1024)
q = getPrime(25)
e = 65537
</code></pre>
<h4><span id="pq差值过大解题代码">pq差值过大解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse
for p in range (2**24,2**25):
    if n % p == 0:
        q = n // p
        print(f&quot;Found factors:\np = {p}\nq = {q}&quot;)
        break
e = 65537
m = pow(c, inverse(e, (p-1)*(q-1)), n)
print(f&quot;Decrypted message:\n{long_to_bytes(m)}&quot;)
</code></pre>
<h3><span id="pq差值过小例题">pq差值过小例题</span></h3><h4><span id="pq差值过小题目">pq差值过小题目</span></h4><h4><span id="pq差值过小解题代码">pq差值过小解题代码</span></h4><h2><span id="rsa-模不互素">RSA 模不互素</span></h2><h3><span id="模不互素出题思路">模不互素出题思路</span></h3><p>模数用了相同的质数，可以通过最大公约数求解</p>
<h3><span id="模不互素例题">模不互素例题</span></h3><h4><span id="模不互素题目">模不互素题目</span></h4><pre><code class="language-python">from Crypto.Util.number import getPrime,bytes_to_long

flag=open(&quot;flag&quot;,&quot;rb&quot;).read()

p=getPrime(1024)
q=getPrime(1024)
assert(e&lt;100000)
n=p*q
m=bytes_to_long(flag)
c=pow(m,e,n)
print(c,n)
print(pow(294,e,n))

p=getPrime(1024)
n=p*q
m=bytes_to_long(&quot;BJD&quot;*32)
c=pow(m,e,n)
print(c,n)

&#39;&#39;&#39;
output:
12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037
381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018
979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047
&#39;&#39;&#39;
</code></pre>
<h4><span id="模不互素解题代码">模不互素解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes
import gmpy2 as gp

 #assert(e&lt;100000)
 #task = pow(294,e,n1)
c1 =
n1 =
task =
c2 =
n2 =

q = gp.gcd(n1, n2)
p1 = n1 // q
p2 = n2 // q
phi1 = (p1 - 1)*(q - 1)
phi2 = (p2 - 1)*(q - 1)

&quot;&quot;&quot;
for e in range(3, 100000):
    if pow(294,e,n1) == task:
        print(f&quot;Found e: {e}&quot;)
&quot;&quot;&quot;

e = 52361
d1 = gp.invert(e, phi1)
d2 = gp.invert(e, phi2)

m1 = pow(c1, d1, n1)
m2 = pow(c2, d2, n2)
print(long_to_bytes(m1))
print(long_to_bytes(m2))
</code></pre>
<h2><span id="rsa-共模攻击">RSA 共模攻击</span></h2><h3><span id="共模攻击出题思路">共模攻击出题思路</span></h3><p>对于同一个模数n，用于加密同一个m，但是用不同e加密两次<br>$m^{e_1} \equiv c_1 \ (\bmod \ n)$<br>$m^{e_2} \equiv c_2 \ (\bmod \ n)$</p>
<p>使用欧拉定理可以破解,构造<br>$re_1 + se_2 &#x3D; gcd(e_1,e_2)$</p>
<p>则由<br>$c_{1}^r + c_{2}^s \equiv m^{er_1 + se_2} \ (\bmod \ n)$<br>从而绕过私钥d解密</p>
<h3><span id="共模攻击例题">共模攻击例题</span></h3><h4><span id="共模攻击题目">共模攻击题目</span></h4><pre><code class="language-python">c1=22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361
n=22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801
e1=11187289
c2=18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397
e2=9647291
</code></pre>
<h4><span id="共模攻击解题代码">共模攻击解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse
import gmpy2 as gp

c1 =
n =
e1 =
c2 =
e2 =

g,r,s = gp.gcdext(e1, e2)
m_g = pow(c1, r, n) * pow(c2, s, n) % n
m, ok = gp.iroot(m_g,g)
print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-已知ed爆破">RSA 已知ed爆破</span></h2><p>密钥关系推导<br>$e × d &#x3D; 1 + k × \phi(n)$<br>确定$\phi$的范围(用n近似)，还有ed范围进行爆破</p>
<h3><span id="出题思路">出题思路</span></h3><h3><span id="已知ed爆破例题">已知ed爆破例题</span></h3><h4><span id="已知ed爆破题目">已知ed爆破题目</span></h4><pre><code class="language-python">from Crypto.Util.number import *
from flag import flag

def nextPrime(n):
    n += 2 if n &amp; 1 else 1
    while not isPrime(n):
        n += 2
    return n

p = getPrime(1024)
q = nextPrime(p)
n = p*q
e = 0x10001
d = inverse(e, (p-1)*(q-1))
c = pow(bytes_to_long(flag.encode()), e, n)

d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804
</code></pre>
<h4><span id="已知ed爆破解题代码">已知ed爆破解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import *
from bitarray import bitarray
import gmpy2 as gp
import sympy

e =
d =
c =

ed = bitarray(bin(e*d - 1) [2:])
print(&quot;ed =&quot;, ed) # 2065

count = 0
for k in range(pow(2,15),pow(2,16)):
    if (e*d - 1 ) % k == 0:
        count += 1
        phi = (e*d - 1) // k
        p = sympy.prevprime(gp.iroot(phi,2) [0])
        q = sympy.nextprime(p)
        #print(&quot;count =&quot;, count, &quot;phi =&quot;, phi)
        if (p - 1) * (q - 1) == phi:
            print(&quot;Found p and q:&quot;)
            print(&quot;p =&quot;, p)
            print(&quot;q =&quot;, q)
            break

n = p * q
m = pow(c, d, n)
print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-e和phi不互质">RSA e和phi不互质</span></h2><h3><span id="e和phi不互质出题思路">e和phi不互质出题思路</span></h3><p>这情况下，解密时用e&#x2F;gcd(e,phi)，并且m也开gcd(e,phi)次方</p>
<h3><span id="e和phi不互质例题">e和phi不互质例题</span></h3><h4><span id="e和phi不互质题目">e和phi不互质题目</span></h4><pre><code class="language-python">from gmpy2 import lcm , powmod , invert , gcd , mpz
from Crypto.Util.number import getPrime
from sympy import nextprime
from random import randint
p = getPrime(1024)
q = getPrime(1024)
n = p * q
gift = lcm(p - 1 , q - 1) #最小公倍数，所以phi为gift的偶数倍
e = 54722
flag = b&#39;NPUCTF{******************}&#39;
m = int.from_bytes(flag , &#39;big&#39;)
c = pow(m , e , n)
print(&#39;n: &#39; , n)
print(&#39;gift: &#39; , gift)
print(&#39;c: &#39; , c)

n =  17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121
gift =  2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104
c =  3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319
</code></pre>
<h4><span id="e和phi不互质解题代码">e和phi不互质解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import inverse,long_to_bytes
from math import gcd
import gmpy2 as gp

n =
gift =
c =
e =

for k in range(1,1000000):
    phi = 2*k*gift
    if phi &lt; n -1:
        g = gcd(phi,e)
        e_true = e // g
        phi_true = phi // g
        d = inverse(e_true, phi_true)
        m = pow(c, d, n)
        m_true = gp.iroot(m, g) [0]
        m_bytes = long_to_bytes(m_true)
        print(f&quot;Trying k={k}: {m_bytes}\n&quot;)
</code></pre>
<h2><span id="rsa-欧拉函数相关运用">RSA 欧拉函数相关运用</span></h2><h3><span id="欧拉函数相关运用出题思路">欧拉函数相关运用出题思路</span></h3><p>明确欧拉函数的定义<br>$m ^ e \equiv c \ (\bmod \ n)$<br>$c ^ d \equiv m \ (\bmod \ n)$<br>将n分解为所有质因数的乘积，然后算出$\phi(n)$,才有关系<br>$e × d \equiv 1 \ (\bmod \ \phi(n))$</p>
<p>关于欧拉函数有如下公式：<br>$\phi(n) &#x3D; \prod_{i&#x3D;1}^{m} \phi(n_i)$<br>$\phi(p^k) &#x3D; p^{k-1}\phi(p)$<br>$\phi(p) &#x3D; p-1$</p>
<h3><span id="欧拉函数相关运用例题">欧拉函数相关运用例题</span></h3><h4><span id="欧拉函数相关运用题目">欧拉函数相关运用题目</span></h4><pre><code class="language-python">import sympy
import random
from gmpy2 import gcd, invert
from Crypto.Util.number import getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes
from z3 import *
flag = b&quot;MRCTF{xxxx}&quot;
base = 65537

def GCD(A):
    B = 1
    for i in range(1, len(A)):
        B = gcd(A[i-1], A[i])
    return B

def gen_p():
    P = [0 for i in range(17)]
    P[0] = getPrime(128)
    for i in range(1, 17):
        P[i] = sympy.nextprime(P[i-1])
    print(&quot;P_p :&quot;, P[9])
    n = 1
    for i in range(17):
        n *= P[i]
    p = getPrime(1024)
    factor = pow(p, base, n)
    print(&quot;P_factor :&quot;, factor)
    return sympy.nextprime(p)

def gen_q():
    sub_Q = getPrime(1024)
    Q_1 = getPrime(1024)
    Q_2 = getPrime(1024)
    Q = sub_Q ** Q_2 % Q_1
    print(&quot;Q_1: &quot;, Q_1)
    print(&quot;Q_2: &quot;, Q_2)
    print(&quot;sub_Q: &quot;, sub_Q)
    return sympy.nextprime(Q)

if __name__ == &quot;__main__&quot;:
    _E = base
    _P = gen_p()
    _Q = gen_q()
    assert (gcd(_E, (_P - 1)*(_Q - 1)) == 1)
    _M = bytes_to_long(flag)
    _C = pow(_M,_E, _P*_Q)
    print(&quot;Ciphertext = &quot;, _C)
&#39;&#39;&#39;
P_p : 206027926847308612719677572554991143421
P_factor : 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839
Q_1:  103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521
Q_2:  151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743
sub_Q:  168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651
Ciphertext =  1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832
&#39;&#39;&#39;
</code></pre>
<h4><span id="欧拉函数相关运用解题代码">欧拉函数相关运用解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse
import sympy

Q_1 =
Q_2 =
sub_Q =
Q = pow(sub_Q, Q_2, Q_1)
q = sympy.nextprime(Q)
print(&quot;q=&quot;, q)

P_p =
f1 = P_p
f2 = P_p
P_factor =

P=[0 for i in range(17)]
for i in range(9):
    P_p=sympy.prevprime(P_p)
P[0] = P_p

for i in range(1, 17):
    P[i] = sympy.nextprime(P[i-1])

n=1
phi=1
for i in range(17):
    n*=P[i]
    phi*=(P[i]-1)

base = 65537
inv_base = inverse(base,phi)
p = sympy.nextprime(pow(P_factor, inv_base, n))
print(&quot;p=&quot;, p)

e = base
d = inverse(e, (p - 1)*(q - 1))
Ciphertext =
m = pow(Ciphertext,d,p*q)
print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-简单pem分解">RSA 简单pem分解</span></h2><h3><span id="简单pem分解出题思路">简单pem分解出题思路</span></h3><p>直接给出pem格式的公钥文件，要求分解出n和e，然后解密<br>注意格式，尝试用cryptography库</p>
<h3><span id="简单pem分解例题">简单pem分解例题</span></h3><h4><span id="简单pem分解题目">简单pem分解题目</span></h4><p>—–BEGIN PUBLIC KEY—–<br>MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+<br>&#x2F;AvKr1rzQczdAgMBAAE&#x3D;<br>—–END PUBLIC KEY—–</p>
<h4><span id="简单pem分解解题代码">简单pem分解解题代码</span></h4><pre><code class="language-python">from Crypto.PublicKey import RSA
from Crypto.Util.number import inverse,long_to_bytes
from cryptography.hazmat.primitives import serialization

 #把PEM公钥内容复制到这里（包含BEGIN/END部分）
pem_public_key = &quot;&quot;&quot;   &quot;&quot;&quot;

 #加载PEM公钥并提取e和n
public_key = serialization.load_pem_public_key(
    pem_public_key.encode(&quot;utf-8&quot;)  # 转换为字节流
)
public_numbers = public_key.public_numbers()

 #输出结果
print(&quot;公钥指数 e =&quot;, public_numbers.e)
print(&quot;模数 n =&quot;, public_numbers.n)

n = public_numbers.n
e = public_numbers.e

p = 285960468890451637935629440372639283459
q = 304008741604601924494328155975272418463

phi = (p - 1) * (q - 1)
d = inverse(e, phi)
print(&quot;私钥指数 d =&quot;, d)

with open(r&quot;flag.enc&quot;,&quot;rb&quot;) as f:
    c = f.read()
m = pow(int.from_bytes(c, &#39;big&#39;), d, n)
print(&quot;明文 m =&quot;, long_to_bytes(m))
</code></pre>
<h2><span id="rsa-wiener攻击">RSA wiener攻击</span></h2><h3><span id="wiener攻击出题思路">wiener攻击出题思路</span></h3><p>wiener攻击是针对d非常小的RSA私钥的攻击方法<br>通过连分数逼近e&#x2F;n，找到可能的k&#x2F;d对，从而计算出phi和n的因子<br>特征是与n大小非常接近的e值</p>
<h3><span id="wiener攻击例题">wiener攻击例题</span></h3><h4><span id="wiener攻击题目">wiener攻击题目</span></h4><pre><code class="language-python">N = 101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471
e = 46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085

import hashlib
flag = &quot;flag{&quot; + hashlib.md5(hex(d)).hexdigest() + &quot;}&quot;

#### wiener攻击解题代码

 #sage运行得到d
&quot;&quot;&quot;
def recover(e, N):
    e = Integer(e)
    N = Integer(N)
    cf = continued_fraction(e / N).convergents()
    G.&lt;x&gt; = ZZ[&#39;x&#39;]

    for k_frac in cf[1:]:
        d0 = k_frac.denominator()
        k = k_frac.numerator()
        if k == 0 or d0 == 0:
            continue
        if (e * d0 - 1) % k != 0:
            continue
        phi = (e * d0 - 1) // k
        s = N - phi + 1
        f = x^2 - s*x + N
        discriminant = f.discriminant()
        if discriminant &lt;= 0 or not discriminant.is_square():
            continue
        roots = f.roots(multiplicities=False)
        roots = [Integer(root) for root in roots if root.is_integer()]
        if len(roots) == 2 and roots[0] * roots[1] == N:
            p, q = roots
            true_phi = (p - 1) * (q - 1)
            if (e * d0) % true_phi == 1:
                print(f&quot;[x] 恢复成功！&quot;)
                print(f&quot;d = {d0}&quot;)
                print(f&quot;d (十六进制) = {hex(d0)}&quot;)
                print(f&quot;p = {p}&quot;)
                print(f&quot;q = {q}&quot;)
                print(f&quot;phi(N) = {true_phi}&quot;)
                print(f&quot;验证：e*d \bmod phi(N) = {(e*d0) % true_phi}（应为1）&quot;)
                return d0  # 返回正确的d
    print(&quot;[-] 恢复失败&quot;)
    return None

d = recover(e,N)
&quot;&quot;&quot;

N = 
e = 

import hashlib
d = 
d_hex = hex(d)
md5_input = d_hex[2:].encode()  # 去掉 &#39;0x&#39; 前缀并编码为字节
md5_hash = hashlib.md5(md5_input).hexdigest()

flag =&quot;flag{&quot; + md5_hash + &quot;}&quot;
print(flag)
</code></pre>
<h2><span id="rsa-dp泄露">RSA dp泄露</span></h2><h3><span id="dp泄露出题思路">dp泄露出题思路</span></h3><p>如果我们已知dp，则可以推导出关系<br>$dp \equiv d \ (\bmod \ p-1)$<br>$e × d \equiv 1 \ (\bmod \ (p-1)(q-1))$<br>结合关系可得到<br>$e × dp \equiv 1 \ (\bmod \ (p-1))$</p>
<h3><span id="dp泄露例题一e较小时可以爆破">dp泄露例题一(e较小时可以爆破)</span></h3><h4><span id="dp泄露题目一">dp泄露题目一</span></h4><pre><code class="language-python">e = 65537
n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847
c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869
dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825
</code></pre>
<h4><span id="dp泄露解题代码一">dp泄露解题代码一</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes
import gmpy2 as gp

e = 65537
n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847
c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869
dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825

for k in range(2,e):
    if (e*dp - 1) % k == 0:
        p = (e*dp - 1) // k + 1
        print(f&quot;p = {p}&quot;)
        q = n // p
        print(f&quot;q = {q}&quot;)
        phi = (p-1)*(q-1)
        d = gp.invert(e, phi)
        m = pow(c, d, n)
        print(f&quot;m = {m}&quot;)
        flag = long_to_bytes(m)
        print(f&quot;flag = {flag}&quot;)
</code></pre>
<h3><span id="dp泄露例题二e较大时小费马定理">dp泄露例题二(e较大时小费马定理)</span></h3><h4><span id="小费马定理">小费马定理</span></h4><p>如果p是一个质数，整数a不是p的倍数，那么<br>$a^{p-1} \equiv 1 \ (\bmod \ p)$</p>
<p>RSA中的运用<br>$e × dp \equiv 1 \ (\bmod \ (p-1))$<br>由$e × dp &#x3D; 1 + k(p-1)$<br>则$a^{e×dp} \equiv a \cdot (a^{p-1})^k$</p>
<p>带入小费马定理得<br>$a^{e×dp} \equiv a \cdot 1^k \equiv a \ (\bmod \ p)$</p>
<p>令a &#x3D; 2，显然与p互质<br>$2^{e×dp} \equiv 2 \ (\bmod \ p)$<br>故找到$2^{e×dp} - 2$和n的最大公约数即可得到p</p>
<h4><span id="dp泄露题目二">dp泄露题目二</span></h4><pre><code class="language-python">c = 82404436498466895324733436901056359489189960512493202570903960333247277400247388969097533191635462377037232768074464944681385506170855774688613792302290304494481765906529480985984818897269069587516233500512849282866396228645039453616712857020451120948641770106851301755195757766245239907077580562163260112662
n_hex = &quot;0x9d034fa9ab29cabdcdff047e688e751704c756cbd2f38bd4f049a3a0889ea4cbffd006b58608d6a7f7c09835ca0abb1db23ad1ca223c54acf87e2dd823996fbfa5a58f272ae7a10c394aa0fe16fa8d4e31bb024bf1f93517c8c7e52fdaa876b58111b97fc66374d506e2be8dfaf94d6614307ee8b10d93fdc1c165c7563d03bd&quot;
e_hex = &quot;0xbeed55cdffde31057bea5a58a3684d5fbed81f03d53fa28bb658b32de4535c8d&quot;
dp_hex = &quot;0x26b285848e6997fa01376059a8b4dff8d69c1aa4c5af399b8bb45515a378de45d85eed75bab5f22d39dc7c95c1a5186d18576c2f7d638acc21898469f728d3fb&quot;
</code></pre>
<h4><span id="dp泄露解题代码二">dp泄露解题代码二</span></h4><pre><code class="language-python">p = gp.gcd((pow(2,e*dp,n) -2) ,n) #核心步骤
q = n // p
if n == p * q and p &gt; 1 and q &gt; 1:
    print(&quot;成功分解n:&quot;)
    print(&quot;p =&quot;, p)
    print(&quot;q =&quot;, q)
    phi = (p - 1) * (q - 1)
    d = gp.invert(e, phi)
    m = pow(c, d, n)
    print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-密文填充">RSA 密文填充</span></h2><h3><span id="密文填充出题思路">密文填充出题思路</span></h3><p>RSA加密前对明文进行填充，常见的填充方式有PKCS#1 v1.5和OAEP<br>使用Crypto.Cipher库进行去填充化</p>
<h3><span id="密文填充例题">密文填充例题</span></h3><h4><span id="密文填充题目">密文填充题目</span></h4><p>—–BEGIN PUBLIC KEY—–<br>MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc&#x2F;4<br>3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv<br>tcMIJ9&#x2F;PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59<br>NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT<br>+EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM&#x2F;r6ED5Nsozof1oMbt<br>Si8mZEJ&#x2F;Vlx3gathkUVtlxx&#x2F;+jlScjdM7AFV5fkRidt0LkwosDoPoRz&#x2F;sDFz0qTM<br>5q5TAgMBAAE&#x3D;<br>—–END PUBLIC KEY—–</p>
<p>flag.enc &#x3D;<br>‘GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW&#x2F;MgPwxVBSl46joFCQ1plcnlDGfL19K&#x2F;3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK&#x2F;1EYU7NzrhGE7J5jPdi0Aj7xi&#x2F;Odxy0hGMgpaBLd&#x2F;nL3N8O6i9pc4Gg3O8soOlciBG&#x2F;6&#x2F;xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA&#x3D;&#x3D;’</p>
<h4><span id="密文填充解题代码">密文填充解题代码</span></h4><pre><code class="language-python">from cryptography.hazmat.primitives import serialization
from Crypto.Util.number import inverse,long_to_bytes
from Crypto.Cipher import PKCS1_OAEP
from Crypto.PublicKey import RSA

pem_public_key = &quot;&quot;&quot;   &quot;&quot;&quot;
public_key = serialization.load_pem_public_key(
    pem_public_key.encode(&quot;utf-8&quot;)  
)
public_numbers = public_key.public_numbers()

print(&quot;公钥指数 e =&quot;, public_numbers.e)
print(&quot;模数 n =&quot;, public_numbers.n)

# Attempt OAEP unpadding (SHA1 and SHA256) on the raw decrypted block.
import hashlib, binascii
import base64
# Re-use previous variables from the last run if available; else reinitialize.
# For safety, reassign here:
n = public_numbers.n
e = public_numbers.e
p =     
q = 

c_b64 = 
c_bytes = base64.b64decode(c_b64)
c_int = int.from_bytes(c_bytes,&#39;big&#39;)

c = c_int
d = inverse(e, (p-1)*(q-1))
m = pow(c, d, n)
print(long_to_bytes(m))

key = RSA.construct((n,e,d,p,q))
cipher = PKCS1_OAEP.new(key)
decrypted = cipher.decrypt(c_bytes)
print(decrypted)
</code></pre>
<h2><span id="rsa-中国剩余定理ctr攻击">RSA 中国剩余定理CTR攻击</span></h2><h3><span id="中国剩余定理ctr攻击出题思路">中国剩余定理CTR攻击出题思路</span></h3><p>利用CRT加速RSA解密的特性，用多个不同模数进行加密，得到多个密文<br>关系如下<br>$c_1 \equiv m^e \ (\bmod \ n_1)$<br>$c_2 \equiv m^e \ (\bmod \ n_2)$<br>$c_3 \equiv m^e \ (\bmod \ n_3)$<br>通过CRT将这些同余方程合并成一个方程，然后使用e次根<br>$N &#x3D; n_1 × n_2 × n_3$<br>$m^e \equiv c_1×M_1 + c_2×M_2 + c_3×M_3 \ (\bmod \ N)$<br>其中$M_i &#x3D; N&#x2F;n_i × [(N&#x2F;n_i)^{-1} \ (\bmod \ n_i)]$以此类推</p>
<h3><span id="中国剩余定理ctr攻击例题">中国剩余定理CTR攻击例题</span></h3><h4><span id="中国剩余定理ctr攻击题目">中国剩余定理CTR攻击题目</span></h4><pre><code class="language-python">N = 331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004 
c = 310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243

N = 302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114 
c = 112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344

N = 332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323 
c = 10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242
</code></pre>
<h4><span id="中国剩余定理ctr攻击解题代码">中国剩余定理CTR攻击解题代码</span></h4><pre><code class="language-python">
from Crypto.Util.number import long_to_bytes
import gmpy2
 
n1 = int(&#39;331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004&#39;,5)
c1 = int(&#39;310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243&#39;,5)
 
n2 = int(&#39;302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114&#39;,5)
c2 = int(&#39;112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344&#39;,5)
 
n3 = int(&#39;332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323&#39;,5)
c3 = int(&#39;10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242&#39;,5)
 
M1=n2*n3*gmpy2.invert(n2*n3,n1)
M2=n1*n3*gmpy2.invert(n1*n3,n2)
M3=n1*n2*gmpy2.invert(n1*n2,n3)
 
num=c1*M1+c2*M2+c3*M3
me=num%(n1*n2*n3)
print(long_to_bytes(me))
for e in range(2,10000000):
    m, ok= gmpy2.iroot(me, e)
    if ok:
        break
print(long_to_bytes(int(m)))
</code></pre>
<h2><span id="rsa-多n分解公因数">RSA 多n分解公因数</span></h2><h3><span id="多n分解公因数出题思路">多n分解公因数出题思路</span></h3><p>特征有非常多的密文和模数，尝试看看会不会有n有相同的公因数</p>
<h3><span id="多n分解公因数例题">多n分解公因数例题</span></h3><h4><span id="多n分解公因数题目">多n分解公因数题目</span></h4><pre><code class="language-python">m = xxxxxxxx
e = 65537
========== n c ==========
n = 20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207
c = 974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320

n = 20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759
c = 15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855

n = 25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491
c = 4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862

n = 21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751
c = 4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613

n = 22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067
c = 15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357

n = 21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369
c = 20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932

n = 25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137
c = 19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179

n = 22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191
c = 6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006

n = 23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941
c = 5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934

n = 28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491
c = 9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869

n = 22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019
c = 1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467

n = 27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299
c = 21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971

n = 20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551
c = 14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175

n = 27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987
c = 3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457

n = 27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837
c = 14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842

n = 25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451
c = 17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724

n = 23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499
c = 10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024

n = 19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973
c = 3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887

n = 19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603
c = 6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889

n = 26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659
c = 386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346
</code></pre>
<h4><span id="多n分解公因数解题代码">多n分解公因数解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes,inverse
from math import gcd

e = 65537
n=[n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19]
c=[c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19]

for i in range(len(n)):
    for j in range(len(n)):
        if(i!=j):
            if(gcd(n[i],n[j])!=1):   #对不同的n进行 欧几里得算法，以求出最大公约数(p)
                print(i,j)                 #输出对应的n的序号            
                p = gcd(n[i],n[j])
                print(&quot;p = &quot;,p)
                q = n[i] // p
                print(&quot;q = &quot;,q)
                d = inverse(e , (p-1)*(q-1))
                print(&quot;d = &quot;,d)
                m = pow(c[i],d,n[i])
                print(&quot;m = &quot;,m)

print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-破损私钥恢复">RSA 破损私钥恢复</span></h2><h3><span id="rsa破损私钥恢复出题思路">RSA破损私钥恢复出题思路</span></h3><h4><span id="rsa私钥pem结构">RSA私钥pem结构</span></h4><p>在文件进行base64解码后，可以看到pem文件的结构如下：</p>
<p>RSAPrivateKey ::&#x3D; SEQUENCE {<br>    version           Version,     0表示两个素数的RSA  1表示多素数的RSA<br>    modulus           INTEGER,  – n<br>    publicExponent    INTEGER,  – e<br>    privateExponent   INTEGER,  – d<br>    prime1            INTEGER,  – p<br>    prime2            INTEGER,  – q<br>    exponent1         INTEGER,  – d mod (p-1) dp<br>    exponent2         INTEGER,  – d mod (q-1) dq<br>    coefficient       INTEGER,  – (inverse of q) mod p<br>    otherPrimeInfos   OtherPrimeInfos OPTIONAL<br>}</p>
<p>十六进制格式如下：<br>表示头 30<br>表示长度 82 xx xx<br>版本信息 02 01 00<br>n 02 xx xx<br>e 02 xx<br>d 02 xx xx<br>p 02 xx<br>q 02 xx<br>dp 02 xx<br>dq 02 xx<br>inv 02 xx<br>如果数据长度超过128字节，则长度部分会多出两个字节表示实际长度</p>
<h3><span id="破损私钥恢复例题">破损私钥恢复例题</span></h3><h4><span id="破损私钥恢复题目">破损私钥恢复题目</span></h4><pre><code class="language-python">cipher = 82404436498466895324733436901056359489189960512493202570903960333247277400247388969097533191635462377037232768074464944681385506170855774688613792302290304494481765906529480985984818897269069587516233500512849282866396228645039453616712857020451120948641770106851301755195757766245239907077580562163260112662

&quot;&quot;&quot;
-----BEGIN RSA PRIVATE KEY-----
MIICewIBAAKBgQCdA0+pqynKvc3/BH5ojnUXBMdWy9Lzi9TwSaOgiJ6ky//QBrWG
CNan98CYNcoKux2yOtHKIjxUrPh+LdgjmW+/paWPJyrnoQw5SqD+FvqNTjG7Akvx
+TUXyMflL9qodrWBEbl/xmN01Qbivo36+U1mFDB+6LENk/3BwWXHVj0DvQIhAL7t
Vc3/3jEFe+paWKNoTV++2B8D1T+ii7ZYsy3kU1yNAoGAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAkCQQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkEAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAwJAJrKFhI5pl/oBN2BZqLTf+NacGqTFrzmbi7RVFaN43kXYXu11urXy
LTncfJXBpRhtGFdsL31jiswhiYRp9yjT+wJBAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCQQAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAA
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;
</code></pre>
<h4><span id="破损私钥恢复解题代码">破损私钥恢复解题代码</span></h4><pre><code class="language-python">from base64 import b64decode
import binascii
from Crypto.Util.number import long_to_bytes
import gmpy2 as gp

s = &quot;&quot;&quot;

&quot;&quot;&quot;
 
s = b64decode(s)
print(binascii.hexlify(s))

&quot;&quot;&quot;
3082027b
020100
028181 #n
009d034fa9ab29cabdcdff047e688e751704c756cbd2f38bd4f049a3a0889ea4cbffd006b58608d6a7f7c09835ca0abb1db23ad1ca223c54acf87e2dd823996fbfa5a58f272ae7a10c394aa0fe16fa8d4e31bb024bf1f93517c8c7e52fdaa876b58111b97fc66374d506e2be8dfaf94d6614307ee8b10d93fdc1c165c7563d03bd
0221   #e
00beed55cdffde31057bea5a58a3684d5fbed81f03d53fa28bb658b32de4535c8d
028180 #d
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009
0241   #p
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0241   #q
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003
0240   #dp
26b285848e6997fa01376059a8b4dff8d69c1aa4c5af399b8bb45515a378de45d85eed75bab5f22d39dc7c95c1a5186d18576c2f7d638acc21898469f728d3fb
0241   #dq
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003
0241   #inv
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
&quot;&quot;&quot;


c = 82404436498466895324733436901056359489189960512493202570903960333247277400247388969097533191635462377037232768074464944681385506170855774688613792302290304494481765906529480985984818897269069587516233500512849282866396228645039453616712857020451120948641770106851301755195757766245239907077580562163260112662

n_hex = &quot;0x9d034fa9ab29cabdcdff047e688e751704c756cbd2f38bd4f049a3a0889ea4cbffd006b58608d6a7f7c09835ca0abb1db23ad1ca223c54acf87e2dd823996fbfa5a58f272ae7a10c394aa0fe16fa8d4e31bb024bf1f93517c8c7e52fdaa876b58111b97fc66374d506e2be8dfaf94d6614307ee8b10d93fdc1c165c7563d03bd&quot;
n = int(n_hex,16)
e_hex = &quot;0xbeed55cdffde31057bea5a58a3684d5fbed81f03d53fa28bb658b32de4535c8d&quot;
e = int(e_hex,16)
dp_hex = &quot;0x26b285848e6997fa01376059a8b4dff8d69c1aa4c5af399b8bb45515a378de45d85eed75bab5f22d39dc7c95c1a5186d18576c2f7d638acc21898469f728d3fb&quot;
dp = int(dp_hex,16)
p = gp.gcd((pow(2,e*dp,n) -2) ,n)
q = n // p
if n == p * q and p &gt; 1 and q &gt; 1:
    print(&quot;成功分解n:&quot;)
    print(&quot;p =&quot;, p)
    print(&quot;q =&quot;, q)
    phi = (p - 1) * (q - 1)
    d = gp.invert(e, phi)
    m = pow(c, d, n)
    print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-勒让德符号应用">RSA 勒让德符号应用</span></h2><h3><span id="二次剩余定义">二次剩余定义</span></h3><p>若存在整数x使得$x^2 \equiv a \ (\bmod \ p)$(p为奇素数)，则称a为模p的二次剩余，方程无解称为二次非剩余。</p>
<h3><span id="欧拉判别法与勒让德符号">欧拉判别法与勒让德符号</span></h3><p>设p为奇素数，a为整数，则<br>$a^{\frac{p-1}{2}} \equiv \left(\frac{a}{p}\right) \ (\bmod \ p)$</p>
<p>其中，$\left(\frac{a}{p}\right)$为勒让德符号，定义如下：<br>$\left(\frac{a}{p}\right) &#x3D; 0$，若p整除a<br>$\left(\frac{a}{p}\right) &#x3D; 1$，若a为模p的二次剩余<br>$\left(\frac{a}{p}\right) &#x3D; -1$，若a为模p的二次非剩余</p>
<p>推导使用费马小定理转化为方程<br>$a^{p-1} \equiv 1 \ (\bmod \ p)$<br>$\left(\frac{a}{p}\right)$即为下面方程的解<br>$x^2 \equiv 1 \ (\bmod \ p)$</p>
<h3><span id="rsa勒让德符号应用例题">RSA勒让德符号应用例题</span></h3><h4><span id="勒让德符号应用题目">勒让德符号应用题目</span></h4><pre><code class="language-python">from Crypto.Util.number import *
from secret import flag

def gift(m, prime):
    return pow(m, (prime + 1) // 2, prime)

m = bytes_to_long(flag)
p = getPrime(256)
q = getPrime(256)

print(f&#39;p = {p}&#39;)
print(f&#39;q = {q}&#39;)
print(f&#39;gift1 = {gift(m, p)}&#39;)
print(f&#39;gift2 = {gift(m, q)}&#39;)

# p = 71380997427449345634700552609577271052193856747526826598031269184817312570231
# q = 65531748297495117965939047069388412545623909154912018722160805504300279801251
# gift1 = 40365143212042701723922505647865230754866250738391105510918441288000789123995
# gift2 = 10698628345523517254945893573969253712072344217500232111817321788145975103342
</code></pre>
<h4><span id="勒让德符号应用解题代码">勒让德符号应用解题代码</span></h4><pre><code class="language-python">from Crypto.Util.number import long_to_bytes, inverse
import gmpy2 as gp

p =
q =
gift1 =
gift2 =

mp_list = [gift1, -gift1 % p]
mq_list = [gift2, -gift2 % q]

for mp in mp_list:
    print(long_to_bytes(mp))
for mq in mq_list:
    print(long_to_bytes(mq))

for mp in mp_list:
    for mq in mq_list:
        m = mp*inverse(q, p)*q + mq*inverse(p, q)*p
        m = m % (p * q)
        print(long_to_bytes(m))
</code></pre>
<h2><span id="rsa-衍生rabin算法">RSA 衍生Rabin算法</span></h2><h3><span id="rabin算法简介">Rabin算法简介</span></h3><p>Rabin算法是算是RSA的一个特例，e取一个固定值2<br>Rabin的密文与明文并不是一一对应的关系，同一个密文可能解出多种不同的明文<br>Rabin的安全性取决于求解模平方根的难度，破解难度与分解大整数的难度相当</p>
<p>密文：$c &#x3D; m^2 \ (\bmod \ n)$</p>
<p>解密：</p>
<p>$c &#x3D; m^2 \ (\bmod \ p)$<br>$c &#x3D; m^2 \ (\bmod \ q)$</p>
<p>Tonelli-Shanks算法计算$m_p$和$m_q$：<br>分解$p-1 &#x3D; q \cdot 2^s$，其中$q$为奇数<br>找到一个$z$，满足模$p$的二次非剩余，计算$c^s$和$z^s$<br>计算$x$，使得$(z^s)^x \equiv c^s \ (\bmod \ p)$<br>计算$k&#x3D;z^{\frac{sx}{2}} \ (\bmod \ p)$<br>则有解$ \pm kc^{-q}$</p>
<pre><code class="language-python">def tonelli(n, p):
    if n == 0:
        return 0
    if pow(n, (p - 1) // 2, p) != 1:
        print(&quot;No square root exists&quot;)
        return None
    if p % 4 == 3:
        return pow(n, (p + 1) // 4, p)
    q = p - 1
    s = 0
    while q % 2 == 0:
        s += 1
        q //= 2
    z = 2
    while pow(z, (p - 1) // 2, p) != p - 1:
        z += 1
    c = pow(z, q, p)
    x = pow(n, (q + 1) // 2, p)
    t = pow(n, q, p)
    m = s
    while t != 1:
        i = 1
        t2 = pow(t, 2, p)
        while t2 != 1:
            t2 = pow(t2, 2, p)
            i += 1
        b = pow(c, 1 &lt;&lt; (m - i - 1), p)
        x = (x * b) % p
        t = (t * b * b) % p
        c = (b * b) % p
        m = i
    return x

&quot;&quot;&quot;
计算p的k次方模平方根用henell-lift方法
from Crypto.Util.number import inverse
b = tonelli(n, p)
t = 1
while (t != k):
    v = ((a - b*b)//pow(p,t)) % p
    c = (b + pow(p,t)*inverse(2*b, p)*v) % pow(p,t+1)
    b = c
    t += 1
print(c)
&quot;&quot;&quot;
</code></pre>
<p>特别的，如果$p \equiv 3 \ (\bmod \ 4)且 q \equiv 3 \ (\bmod \ 4)$，则<br>$m_p &#x3D; c^{\frac{p+1}{4}} \ (\bmod \ p)$<br>$m_q &#x3D; c^{\frac{q+1}{4}} \ (\bmod \ q)$</p>
<p>用扩展欧几里得算法计算出$y_p$和$y_q$，满足<br>$y_p \cdot p + y_q \cdot q &#x3D; 1$</p>
<p>解出四个明文：<br>$a &#x3D; (y_p \cdot p \cdot m_q + y_q \cdot q \cdot m_p) \ (\bmod \ n)$<br>$b &#x3D; n - a$<br>$c &#x3D; (y_p \cdot p \cdot m_q - y_q \cdot q \cdot m_p) \ (\bmod \ n)$<br>$d &#x3D; n - c$</p>
<h3><span id="rabin算法例题">Rabin算法例题</span></h3><h4><span id="rabin算法题目">Rabin算法题目</span></h4><pre><code class="language-python">from Crypto.Util.number import *
from secret import flag
p = getPrime(64)
q = getPrime(64)
assert p % 4 == 3
assert q % 4 == 3

n = p * q

e = 2
m = bytes_to_long(flag)

c = pow(m,e,n)

print(&#39;n =&#39;, n)
print(&#39;c =&#39;, c)

# n = 201354090531918389422241515534761536573
# c = 20442989381348880630046435751193745753
</code></pre>
<h4><span id="rabin算法解题代码">Rabin算法解题代码</span></h4><pre><code class="language-python">import gmpy2 as gp
from Crypto.Util.number import long_to_bytes

e = 2
n = 201354090531918389422241515534761536573
c = 20442989381348880630046435751193745753

p = 13934102561950901579
q = 14450452739004884887

g, y_p, y_q = gp.gcdext(p, q)
m_p = pow(c,(p + 1) // 4, p)
m_q = pow(c,(q + 1) // 4, q)

a = (y_p * p * m_q + y_q * q * m_p) % n
b = n - a
c = (y_p * p * m_q - y_q * q * m_p) % n
d = n - c

print(long_to_bytes(a))
print(long_to_bytes(b))
print(long_to_bytes(c))
print(long_to_bytes(d))
</code></pre>
<h2><span id="rsa-模数光滑">RSA 模数光滑</span></h2><h3><span id="rsa模数光滑出题思路">RSA模数光滑出题思路</span></h3><p>光滑数的定义：若一个正整数n的所有素因子均小于等于某一给定正整数B，则称n为B-光滑数<br>当p - 1或q - 1是光滑数时，可以使用Pollard’s p-1算法分解n，从而破解RSA<br>当p + 1或q + 1是光滑数时，可以使用Williams’s p + 1算法分解n，从而破解RSA</p>
<h3><span id="rsa模数光滑例题">RSA模数光滑例题</span></h3><h4><span id="rsa模数光滑题目">RSA模数光滑题目</span></h4><pre><code class="language-python">n = 149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897
</code></pre>
<h4><span id="rsa模数光滑解题代码">RSA模数光滑解题代码</span></h4><pre><code class="language-python"># williams&#39;s p+1 factorization
def mlucas(v, a, n):
    v1, v2 = v, (v ** 2 - 2) % n
    for bit in bin(a)[3:]:
        if bit == &quot;0&quot;:
            v1, v2 = (v1 ** 2 - 2) % n, (v1 * v2 - v) % n
        else:
            v1, v2 = (v1 * v2 - v) % n, (v2 ** 2 - 2) % n
    return v1
 
# 素数生成器
def primegen():
    yield from primerange(2, 10**6)  # 生成到 10^6 的素数，够用了
 
# 整数对数：ilog(x, b) = 最大整数 l，使得 b^l &lt;= x
def ilog(x, b):
    l = 0
    while x &gt;= b:
        x //= b
        l += 1
    return l
 
# Williams p+1 分解攻击
def Williams_p_plus_1_attack(n):
    for v in count(1):  # 不断尝试新的 v
        for p in primegen():
            e = ilog(isqrt(n), p)
            if e == 0:
                break
            for _ in range(e):
                v = mlucas(v, p, n)
            g = gcd(v - 2, n)
            if 1 &lt; g &lt; n:
                return int(g), int(n // g)
            if g == n:
                break
 
# 开始攻击
p1, q1 = Williams_p_plus_1_attack(n)
if p1 and q1:
    print(&quot;williams&#39;s p+1 factorization successful!&quot;)
    print(f&quot;p = {p1}&quot;)
    print(f&quot;q = {q1}&quot;)

# pollard&#39;s p-1 factorization
def pollard_p_minus_1(n, B=10**5): # B为素数表的上限,可以根据实际往上调
    a = 2  # 通常选2作为基
    for p in primerange(2, B):
        e = int(isqrt(n).bit_length() / p.bit_length())
        a = pow(a, pow(p, e), n)
    g = gcd(a - 1, n)
    if 1 &lt; g &lt; n:
        return g, n // g
    else:
        return None

p2, q2 = pollard_p_minus_1(n)
if p2 and q2:
    print(&quot;pollard&#39;s p-1 factorization successful!&quot;)
    print(f&quot;p = {p2}&quot;)
    print(f&quot;q = {q2}&quot;)
</code></pre>
<h2><span id="rsa-d泄露攻击">RSA d泄露攻击</span></h2><h3><span id="rsa-d泄露出题思路">RSA d泄露出题思路</span></h3><p>首先，已知RSA的公钥(e, n)和私钥d满足以下关系：<br>$e \cdot d \equiv 1 \ (\bmod \ \phi(n))$<br>所以，存在整数k，使得<br>$e \cdot d - 1 &#x3D; k \cdot \phi(n)$<br>又$ \forall a \in Z_n^*$，满足$a^{ed - 1} \equiv 1 \ (\bmod \ n)$<br>令$a^{ed - 1} - 1 \equiv 2^{s}t $，其中，$t$为奇数<br>可以证明至少一半的$a$满足，存在$i \in [1, s]$，使得<br>$a^{2^{i}t} \equiv 1 \ (\bmod \ n)$<br>如果$a,i$满足上述条件，则gcd$(a^{2^{i}t} - 1, n)$为n的非平凡因子</p>
<h3><span id="rsa-d泄露例题">RSA d泄露例题</span></h3><h4><span id="rsa-d泄露题目">RSA d泄露题目</span></h4></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://LR2006-Robot.github.io">Dorange</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://lr2006-robot.github.io/post/undefined.html">https://lr2006-robot.github.io/post/undefined.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://LR2006-Robot.github.io" target="_blank">奇怪的博客</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/myblog.github.io/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/myblog.github.io/post/undefined.html" title="密码学笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">密码学笔记</div></div><div class="info-2"><div class="info-item-1">古典密码常见的古典密码在计算机时代大部分可以通过计算机的算法完成爆破类似的解密 单表替换密码Caesar Cipher 凯撒密码对于26个字母进行数字映射(a–&gt;0)，然后对于明文映射后加上同一个密钥n，得到密文破解同理转化为数字映射然后同时减去n即可 加密函数：$E_k(x) ≡ (x + k) \ mod \ 26$解密函数：$D_k(x) ≡ (x - k) \ mod \ 26$ 凯撒加密代码实现def caesar_encrypt(plaintext, shift):     &quot;&quot;&quot;     凯撒密码加密函数     :param plaintext: 明文(需要加密的字符串)     :param shift: 移位量(整数，可正可负，正表示向后移，负表示向前移)     :return: 密文(加密后的字符串)     &quot;&quot;&quot;     ciphertext = &quot;&quot;  # 存储最终的密文     for char in plaintext:  # 遍历明文中的每个字符       ...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/myblog.github.io/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/myblog.github.io/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Dorange</div><div class="author-info-description"></div><div class="site-data"><a href="/myblog.github.io/archives/"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/myblog.github.io/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/myblog.github.io/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">RSA 基础定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text">基础字母含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.2.</span> <span class="toc-text">基础字母关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.3.</span> <span class="toc-text">基础定义例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.3.1.</span> <span class="toc-text">基础定义题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.3.2.</span> <span class="toc-text">基础定义解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">RSA 进阶定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">2.1.</span> <span class="toc-text">进阶字母含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">2.2.</span> <span class="toc-text">进阶字母关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">2.3.</span> <span class="toc-text">进阶定义例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">2.3.1.</span> <span class="toc-text">进阶定义题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">2.3.2.</span> <span class="toc-text">进阶定义解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">RSA 简单转化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">3.1.</span> <span class="toc-text">简单转化出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">3.2.</span> <span class="toc-text">简单转化例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.2.1.</span> <span class="toc-text">简单转化题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.2.2.</span> <span class="toc-text">简单转化解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">RSA 方程相关运用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">4.1.</span> <span class="toc-text">方程相关出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">4.2.</span> <span class="toc-text">方程相关例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">4.2.1.</span> <span class="toc-text">方程相关题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">4.2.2.</span> <span class="toc-text">方程相关解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">RSA 小e爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">5.1.</span> <span class="toc-text">小e爆破出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">5.2.</span> <span class="toc-text">小e爆破例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">5.2.1.</span> <span class="toc-text">小e爆破题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">5.2.2.</span> <span class="toc-text">小e爆破解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">RSA pq选取不当</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">6.1.</span> <span class="toc-text">pq选取不当出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">6.2.</span> <span class="toc-text">费马因式分解在RSA中的应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">6.3.</span> <span class="toc-text">pq差值过大例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">6.3.1.</span> <span class="toc-text">pq差值过大题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">6.3.2.</span> <span class="toc-text">pq差值过大解题代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">6.4.</span> <span class="toc-text">pq差值过小例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">6.4.1.</span> <span class="toc-text">pq差值过小题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">6.4.2.</span> <span class="toc-text">pq差值过小解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">RSA 模不互素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">7.1.</span> <span class="toc-text">模不互素出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">7.2.</span> <span class="toc-text">模不互素例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">7.2.1.</span> <span class="toc-text">模不互素题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">7.2.2.</span> <span class="toc-text">模不互素解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">RSA 共模攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">8.1.</span> <span class="toc-text">共模攻击出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">8.2.</span> <span class="toc-text">共模攻击例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">8.2.1.</span> <span class="toc-text">共模攻击题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">8.2.2.</span> <span class="toc-text">共模攻击解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">9.</span> <span class="toc-text">RSA 已知ed爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">9.1.</span> <span class="toc-text">出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">9.2.</span> <span class="toc-text">已知ed爆破例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">9.2.1.</span> <span class="toc-text">已知ed爆破题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">9.2.2.</span> <span class="toc-text">已知ed爆破解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">10.</span> <span class="toc-text">RSA e和phi不互质</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">10.1.</span> <span class="toc-text">e和phi不互质出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">10.2.</span> <span class="toc-text">e和phi不互质例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">10.2.1.</span> <span class="toc-text">e和phi不互质题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">10.2.2.</span> <span class="toc-text">e和phi不互质解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">11.</span> <span class="toc-text">RSA 欧拉函数相关运用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">11.1.</span> <span class="toc-text">欧拉函数相关运用出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">11.2.</span> <span class="toc-text">欧拉函数相关运用例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">11.2.1.</span> <span class="toc-text">欧拉函数相关运用题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">11.2.2.</span> <span class="toc-text">欧拉函数相关运用解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">12.</span> <span class="toc-text">RSA 简单pem分解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">12.1.</span> <span class="toc-text">简单pem分解出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">12.2.</span> <span class="toc-text">简单pem分解例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">12.2.1.</span> <span class="toc-text">简单pem分解题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">12.2.2.</span> <span class="toc-text">简单pem分解解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">13.</span> <span class="toc-text">RSA wiener攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">13.1.</span> <span class="toc-text">wiener攻击出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">13.2.</span> <span class="toc-text">wiener攻击例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">13.2.1.</span> <span class="toc-text">wiener攻击题目</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">14.</span> <span class="toc-text">RSA dp泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">14.1.</span> <span class="toc-text">dp泄露出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">14.2.</span> <span class="toc-text">dp泄露例题一(e较小时可以爆破)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">14.2.1.</span> <span class="toc-text">dp泄露题目一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">14.2.2.</span> <span class="toc-text">dp泄露解题代码一</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">14.3.</span> <span class="toc-text">dp泄露例题二(e较大时小费马定理)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">14.3.1.</span> <span class="toc-text">小费马定理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">14.3.2.</span> <span class="toc-text">dp泄露题目二</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">14.3.3.</span> <span class="toc-text">dp泄露解题代码二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">15.</span> <span class="toc-text">RSA 密文填充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">15.1.</span> <span class="toc-text">密文填充出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">15.2.</span> <span class="toc-text">密文填充例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">15.2.1.</span> <span class="toc-text">密文填充题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">15.2.2.</span> <span class="toc-text">密文填充解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">16.</span> <span class="toc-text">RSA 中国剩余定理CTR攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">16.1.</span> <span class="toc-text">中国剩余定理CTR攻击出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">16.2.</span> <span class="toc-text">中国剩余定理CTR攻击例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">16.2.1.</span> <span class="toc-text">中国剩余定理CTR攻击题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">16.2.2.</span> <span class="toc-text">中国剩余定理CTR攻击解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">17.</span> <span class="toc-text">RSA 多n分解公因数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">17.1.</span> <span class="toc-text">多n分解公因数出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">17.2.</span> <span class="toc-text">多n分解公因数例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">17.2.1.</span> <span class="toc-text">多n分解公因数题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">17.2.2.</span> <span class="toc-text">多n分解公因数解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">18.</span> <span class="toc-text">RSA 破损私钥恢复</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">18.1.</span> <span class="toc-text">RSA破损私钥恢复出题思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">18.1.1.</span> <span class="toc-text">RSA私钥pem结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">18.2.</span> <span class="toc-text">破损私钥恢复例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">18.2.1.</span> <span class="toc-text">破损私钥恢复题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">18.2.2.</span> <span class="toc-text">破损私钥恢复解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">19.</span> <span class="toc-text">RSA 勒让德符号应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">19.1.</span> <span class="toc-text">二次剩余定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">19.2.</span> <span class="toc-text">欧拉判别法与勒让德符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">19.3.</span> <span class="toc-text">RSA勒让德符号应用例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">19.3.1.</span> <span class="toc-text">勒让德符号应用题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">19.3.2.</span> <span class="toc-text">勒让德符号应用解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">20.</span> <span class="toc-text">RSA 衍生Rabin算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">20.1.</span> <span class="toc-text">Rabin算法简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">20.2.</span> <span class="toc-text">Rabin算法例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">20.2.1.</span> <span class="toc-text">Rabin算法题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">20.2.2.</span> <span class="toc-text">Rabin算法解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">21.</span> <span class="toc-text">RSA 模数光滑</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">21.1.</span> <span class="toc-text">RSA模数光滑出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">21.2.</span> <span class="toc-text">RSA模数光滑例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">21.2.1.</span> <span class="toc-text">RSA模数光滑题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">21.2.2.</span> <span class="toc-text">RSA模数光滑解题代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">22.</span> <span class="toc-text">RSA d泄露攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">22.1.</span> <span class="toc-text">RSA d泄露出题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">22.2.</span> <span class="toc-text">RSA d泄露例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">22.2.1.</span> <span class="toc-text">RSA d泄露题目</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myblog.github.io/post/undefined.html" title="RSA题型总结">RSA题型总结</a><time datetime="2026-02-08T09:05:00.000Z" title="发表于 2026-02-08 17:05:00">2026-02-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myblog.github.io/post/undefined.html" title="密码学笔记">密码学笔记</a><time datetime="2026-02-08T02:00:00.000Z" title="发表于 2026-02-08 10:00:00">2026-02-08</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Dorange</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/myblog.github.io/js/utils.js?v=5.5.4"></script><script src="/myblog.github.io/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>